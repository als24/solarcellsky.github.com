seajs.use(["widget/tips","sale/res/js/mod/share.js"],function(a,e){var t="hide",i={shareKey:$("#share_key").val(),skuName:$("#sku_name").val(),restAmount:$("#rest_amount").val(),isFinish:1==$("#is_finish").val(),isShareSelf:1==$("#is_share_self").val(),activityAmount:$("#activity_amount").val(),switchSection:function(a){$(".js-section").addClass(t),$(a).removeClass(t)},playBargainAudio:function(){var a=$("#bargain_audio").get(0),e=$("#bg_audio").get(0);try{e.pause(),a.currentTime=0,a.play(),setTimeout(function(){e.play()},2e3)}catch(t){}},getBargainList:function(){var a=i.getBargainList;a.page||(a.page=1),a.page++;var e={share_key:i.shareKey,page:a.page};$.get("/event/2015092904/get_bargain_list.json",e,function(e){var t=e.retcode,i=e.retmsg;if(a.isBusy=!1,0==t){var s=e.html;e.page>e.max_page&&$.scrollLoad.unregister("bargain_list"),$("#bargain_list").append(s)}else a.page--,$.Tips.showError(t,i)},"json")},bargainFriend:function(){var a=this,e={key:a.shareKey};$.post("/event/2015092904/bargain_friend.json",e,function(e){var t=+e.retcode,i=e.retmsg;0==t?(a.playBargainAudio(),a.switchSection("#bargain_section"),setTimeout(function(){location.reload()},4e3)):$.Tips.showError(t,i)},"json")},bindEvent:function(){var a=this;$(".js-bargain-btn").on($.CLICK,function(e){e.preventDefault(),a.bargainFriend()}),$.scrollLoad.register("bargain_list",a.getBargainList)},initParam:function(){var a=this,t="http://sale.fenqile.com/event/2015092904/bargain.html?key="+a.shareKey,i="我想以"+a.activityAmount+"元购买"+a.skuName+"，快来帮我和分小乐砍砍价！";a.isFinish&&(i="分小乐太给力了，我用"+a.activityAmount+"元就可以买到"+a.skuName+"了！"),a.isShareSelf||(i="我正在帮好友砍价，Ta马上就能以"+a.activityAmount+"元价格购买"+a.skuName+"，一起来帮忙吧！"),e.init({title:i,link:t,imgUrl:"http://cres.fenqile.com/res/sale/2015092904/img/logo.jpg",content:"分期乐二周年，邀请千万大学生来砍价，价格低到难以置信。",success:function(a){$.Stat.clickStat("btn_share_success")}});var s=$("#progress_bar").data("percent");$("#progress_bar").animate({width:s+"%"},2e3,"swing"),$(".js-bg-audio-btn").on($.CLICK,function(a){a.preventDefault();var e=$(this);try{var t=$("#bg_audio").get(0);t.paused?(t.play(),e.addClass("m-stop")):(t.pause(),e.removeClass("m-stop"))}catch(a){}})},init:function(){this.initParam(),this.bindEvent()}};i.init()});
//# sourceMappingURL=http://sale.fenqile.com/res/2015092904/js/bargain.js.map
