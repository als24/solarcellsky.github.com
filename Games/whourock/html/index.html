<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="../css/style-promo.css" type="text/css" rel="stylesheet" />
<meta name="viewport" content="width=640,target-densitydpi=device-dpi,user-scalable=no" />
<title>摇一摇  看你摇到谁？</title>
<script src="//wximg.gtimg.com/wxp/libs/wxmoment/0.0.4/wxmoment.min.js"></script>


<meta name="wxm:timeline_title" content="摇到一个大叔，一开口就跟我谈钱！">
<meta name="wxm:appmessage_title" content="这样摇一摇才好玩！">
<meta name="wxm:appmessage_desc" content="摇到一个大叔，一开口就跟我谈钱！">
<!-- 分享缩略图，必须为绝对路径-->
<meta name="wxm:img_url" content="http://wximg.qq.com/wxp/moment/4k5C25_0/img/share.jpg">
<!-- 分享链接-->
<meta name="wxm:link" content="http://wximg.qq.com/wxp/moment/4k5C25_0/html/index.html">
</head>
<body>

<div class="loading" id="loading" style="display:block;">
    <img src="../img/2.png" class="img animate-load" />
        <p><img src="../img/2-1.png" /></p>
 </div>

<div class="mask"></div>
<div class="popbox"></div>

<div class="box-content" id="main">
    <div class="box-step zhuquan1" style="display:block;">
    
        <!--tada animated infinite-->
      <span class="bj s1-1 tada animated infinite">
                <div class="s1-1-d" style="display:none;"></div>
                <div class="s1-1-u" style="display:none;"></div>
                
          </span>
          <span class="s1-0"></span>
          <span class="s1-2" style="display:none;"></span>
          <span class="s1-3" style="display:none;"></span>
          
          <span class="s1-6">
          <img src="../img/2.png" class="s6-2 daxiao" />
          <a href="https://qian.tenpay.com/weixin/action/extend20150928/index.shtml?showwxpaytitle=1&stat_type=68&stat_data=fm_166_syyytg_18&ADTAG=2015.AD.OCTOP.PYQAD" class="btnlink"></a>
          </span>
          
          <span class="s1-7">摇不了？点这里 >></span>
          
          
  </div>
    <div id="video_container" style="display:none;">
          
            
             <!--video class="friend_video video1"  x-webkit-airplay="true" autoplay  webkit-playsinline="true" preload="auto" src="mp4/1.mp4"></video-->
             <video class="friend_video video2"  x-webkit-airplay="true"   webkit-playsinline="true" preload="auto" src="../media/2.mp4"></video>
             <!--video class="friend_video video3"  x-webkit-airplay="true"   webkit-playsinline="true" preload="auto" src="../media/3.mp4"></video-->
             <div id="WxMomentVideo" class="friend_video video3"></div>
          </div>
    
</div>  

<div style="position:absolute; left:-9999px; overflow:hidden; width:0; height:0;">
     <audio id="sound0" src="../media/mp3.mp3" preload="preload"></audio>
</div>
  
</body>
</html>
<script src="../js/jquery-1.8.3.min.js"></script>
<script src="../js/zepto.min.js"></script><script>window.$$ = window.Zepto</script>
<script src="../js/self-min.js"></script>
<script src="../js/PxLoader.js"></script>
<script src="../js/animate.js"></script>
<script src="../js/Fx.min.js"></script>

<script>
new WxMoment.OrientationTip();

var share = new WxMoment.Share();
var wa = new WxMoment.Analytics({
    projectName: ""
});

// wa.sendEvent('click', 'button01');

</script>

<script>


        if (window.DeviceMotionEvent && !Zhu._Android) { 
            $('.s1-7').remove();
        } else{
            $('.s1-7').show();
            $$('.s1-7').tap( function (){
            $('.s1-7').hide();
                AWARD_FN(); 
            })
            
        }

var video2 = $('.video2')[0]
//var video3 = $('.video3')[0]


video2.pause();
video2.play();
video2.pause();
//video3.pause();


if(Zhu._Android)
{
    $('#video_container').append('<img src="../img/v2.jpg" width="640" height="1008" class="vimg2" />'
    +'<img src="../img/v3.jpg" width="640" height="360" class="vimg3" /><img src="../img/play.png" class="play shan" />')
}






function Shake ( fn ){
    
     $('#sound0')[0].play();
     
     
     
    setTimeout( function (){
         $('.s1-1').show();
     
     $('.s1-1 div').show();
     
     $('.s1-1').removeClass('tada animated infinite bj');
      
      $('.s1-1-d').to({ top : '-20%'} ,.5, function (){
        $('.s1-1-d').to({ top : 0},.5);
     })
      $('.s1-1-u').to({ top : '70%'} ,.5, function (){
        $('.s1-1-u').to({ top : '50%'},.5 , function (){
            
            $('.s1-1').hide();
            if(fn) fn();    
        });
     })     
    } , 200)
}


$('#main').on('click', function(){
    
     if(window.INDEX == 1){
        $('.s1-0').hide();
        Shake( function (){
        
                
                if(Zhu._Android) {
                    $('.vimg2 , .play').show().one('touchend' , function (){
                        
                        $('.vimg2 , .play').unbind('touchend');
                        $('.vimg2').remove();
                        $('.play').hide();
                        $('.friend_video.video2').show();
                        video2.play();
                            
                    })
                    
                }
                
                
                
                window.INDEX = 2;
                $('#video_container').show();
                if(!Zhu._Android) $('.friend_video.video2').show();
                if(!Zhu._Android) video2.play();
        })  
    }


    if(window.INDEX == 2){
        Shake( function (){
        
        
                /*if(Zhu._Android) {
                    
                        $('.vimg3 , .play').show().one('touchend' , function (){
                            $('.vimg3').remove();
                            $('.play').hide();
                            $('.friend_video.video3').show();
                            
                            


                            //video3.play();
                                
                        })
                    
                }*/
                
                //可以通过以下方式控制播放/暂停
                //video.getPlayer().pause();
                //以下可以拉起iOS全屏播放
                //video.getPlayer().enterFullScreen();
                
                window.INDEX = 3;
                $('#video_container').show();
                $('.friend_video.video3').show();
                
                var video = new WxMoment.Video({
                                //请联系接口人确认视频清晰度已调至高清版本
                                //如果要定制“播放按钮”的样式，请使用 CSS 覆盖 .tvp_overlay_play 和 .tvp_button_play 即可
                            
                                vid: "w0018705u45", //视频 vid 取自视频地址：http://v.qq.com/page/a/t/t/a0016gys8ct.html
                                pic: "http://wximg.qq.com/wxp/moment/4k5C25_0/img/v3.jpg", //设置视频默认缩略图
                                oninited: function () {
                                    //播放器在视频载入完毕触发
                                    //video.getPlayer().play();
                                    if(!Zhu._Android) video.getPlayer().play();
                                },
                                onplaying: function () {
                                    //播放器真正开始播放视频第一帧画面时
                                },
                                onpause: function () {
                                    //播放器触发暂停时，目前只针对HTML5播放器有效
                                },
                                onresume: function () {
                                    //暂停后继续播放时触发
                                },
                                onallended: function () {
                                    
                                        $('.friend_video.video3').remove();
                                        $('#video_container').hide();   
                                        $('.s1-6').show();  
                                        
                                        
                                        
                                        setTimeout( function (){
                                            location.href = '#' 
                                        } , 5000)
                                        
                                                                
                                    //播放器播放完毕时
                                },
                                onfullscreen: function (isfull) {
                                    //onfullscreen(isfull) 播放器触发全屏/非全屏时，参数isfull表示当前是否是全屏
                                }
                    });
                    //video.getPlayer().play();

                
                //if(!Zhu._Android) video3.play();
        })  
    }
});


/*
video1.addEventListener("ended", function(){
                                    $('.friend_video.video1').remove();
                                    $('#video_container').hide();   
                                    $('.s1-2').show();
                                    tracker = new _liuLiang.gravitySensor ();
                                    tracker.listenShake ( function () {
                                    $('.s1-2').hide();
                                            AWARD_FN();
                                            tracker.stopListenShake ();
                                    } , 200);
});
*/


video2.addEventListener("ended", function(){
                                    $('.s1-7').show();
                                    $('.friend_video.video2').remove();
                                    $('#video_container').hide();   
                                    $('.s1-3').show();
                                    $('.s1-1').show();  
                                    $('.s1-1').addClass('tada animated infinite bj');
                                    $('.s1-1 div').hide();
                                    tracker = new _liuLiang.gravitySensor ();
                                    tracker.listenShake ( function () {
                                            $('.s1-3').hide();
                                            AWARD_FN();
                                            tracker.stopListenShake ();
                                    } , 200);   
                                    
    
});



    
    
    
/*
video3.addEventListener("ended", function(){
    
    
                                    $('.friend_video.video2').remove();
                                    $('#video_container').hide();   
                                    $('.s1-6').show();  
});                             
        */                      

            window.INDEX = 1;
        
            function AWARD_FN (){
                
                 
                    $('.s1-7').hide();
                 
                    if(window.INDEX == 1){
                        $('.s1-0').hide();
                        Shake( function (){
                        
                                
                                if(Zhu._Android) {
                                    $('.vimg2 , .play').show().one('touchend' , function (){
                                        
                                        $('.vimg2 , .play').unbind('touchend');
                                        $('.vimg2').remove();
                                        $('.play').hide();
                                        $('.friend_video.video2').show();
                                        video2.play();
                                            
                                    })
                                    
                                }
                                
                                
                                
                                window.INDEX = 2;
                                $('#video_container').show();
                                if(!Zhu._Android) $('.friend_video.video2').show();
                                if(!Zhu._Android) video2.play();
                        })  
                    }
                
                
                    if(window.INDEX == 2){
                        Shake( function (){
                        
                        
                                /*if(Zhu._Android) {
                                    
                                        $('.vimg3 , .play').show().one('touchend' , function (){
                                            $('.vimg3').remove();
                                            $('.play').hide();
                                            $('.friend_video.video3').show();
                                            
                                            


                                            //video3.play();
                                                
                                        })
                                    
                                }*/
                                
                                //可以通过以下方式控制播放/暂停
                                //video.getPlayer().pause();
                                //以下可以拉起iOS全屏播放
                                //video.getPlayer().enterFullScreen();
                                
                                window.INDEX = 3;
                                $('#video_container').show();
                                $('.friend_video.video3').show();
                                
                                var video = new WxMoment.Video({
                                                //请联系接口人确认视频清晰度已调至高清版本
                                                //如果要定制“播放按钮”的样式，请使用 CSS 覆盖 .tvp_overlay_play 和 .tvp_button_play 即可
                                            
                                                vid: "w0018705u45", //视频 vid 取自视频地址：http://v.qq.com/page/a/t/t/a0016gys8ct.html
                                                pic: "http://wximg.qq.com/wxp/moment/4k5C25_0/img/v3.jpg", //设置视频默认缩略图
                                                oninited: function () {
                                                    //播放器在视频载入完毕触发
                                                    //video.getPlayer().play();
                                                    if(!Zhu._Android) video.getPlayer().play();
                                                },
                                                onplaying: function () {
                                                    //播放器真正开始播放视频第一帧画面时
                                                },
                                                onpause: function () {
                                                    //播放器触发暂停时，目前只针对HTML5播放器有效
                                                },
                                                onresume: function () {
                                                    //暂停后继续播放时触发
                                                },
                                                onallended: function () {
                                                    
                                                        $('.friend_video.video3').remove();
                                                        $('#video_container').hide();   
                                                        $('.s1-6').show();  
                                                        
                                                        
                                                        
                                                        setTimeout( function (){
                                                            location.href = '#' 
                                                        } , 5000)
                                                        
                                                                                
                                                    //播放器播放完毕时
                                                },
                                                onfullscreen: function (isfull) {
                                                    //onfullscreen(isfull) 播放器触发全屏/非全屏时，参数isfull表示当前是否是全屏
                                                }
                                    });
                                    //video.getPlayer().play();

                                
                                //if(!Zhu._Android) video3.play();
                        })  
                    }
                
                
                
            }


            
            






if(!Zhu._Android){
    
var videoScale = $(window).height() / $(window).width() -0.575;


if($(window).height() > 900) $('.friend_video.video2').attr('style','-webkit-transform: scale('+videoScale+');transform: scale('+videoScale+');');



}

</script>




