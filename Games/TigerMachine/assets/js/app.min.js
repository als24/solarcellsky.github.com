(function(e) {
    var t = {};
    t.User = {};
    t.Game = {};
    t.Fn = {};
    t.Audio = {};
    t.Text = {};
    t.init = function() {
        var n = e("#minBet");
        var r = e("#maxBet");
        var i = e("#Spin");
        t.Game.Controls();
        t.Game.Generate();
        if (t.Fn.Mobile()) {
            t.Game.HidControls.hide()
        } else {
            t.Game.HidControls.focus()
        }
        t.Game.Coins.html(t.User.Cash);
        t.Game.Bet.html(t.User.Bet);
        if (t.User.Cash <= 1) {
            n.addClass("disabled");
            r.addClass("disabled")
        }
        if (t.User.Cash == 0) {
            i.addClass("disabled");
            t.Text.All.hide();
            t.Text.MoneyOver.fadeIn("slow")
        }
    };
    t.User.Cash = 50;//初始金币数
    t.User.Bet = 1;//默认投注额
    t.Game.HidControls = e("#hiddenControls");
    t.Game.FirstList = e("#sevenFirst");
    t.Game.SecondList = e("#sevenSecond");
    t.Game.ThirdList = e("#sevenThird");
    t.Game.Coins = e("#Coins");
    t.Game.Bet = e("#Bet");
    t.Game.FirstItem = null;
    t.Game.SecondItem = null;
    t.Game.ThirdItem = null;
    t.Game.Stop = false;
    t.Game.Appended = false;
    t.Game.FirstRandom = 40;
    t.Game.SecondRandom = t.Game.FirstRandom + 2;
    t.Game.ThirdRandom = t.Game.SecondRandom + 2;
    t.Game.Percentages = [5, 10, 10, 10, 15, 20, 20];
    t.Audio.ElButton = document.createElement("audio");
    t.Audio.ElJackpot = document.createElement("audio");
    t.Audio.ElNoMoney = document.createElement("audio");
    t.Audio.ElSpin = document.createElement("audio");
    t.Audio.ElWin = document.createElement("audio");
    t.Audio.Jackpot = function() {
        t.Audio.ElJackpot.setAttribute("src", "assets/sound/jackpot.mp3");
        t.Audio.ElJackpot.addEventListener("ended", function() {
            t.Audio.ElJackpot.setAttribute("src", "");
            t.Audio.ElJackpot.setAttribute("src", "assets/sound/jackpot.mp3");
            t.Audio.ElJackpot.play()
        }, false);
        t.Audio.ElJackpot.play()
    };
    t.Audio.Button = function() {
        t.Audio.ElButton.setAttribute("src", "assets/sound/button.mp3");
        t.Audio.ElButton.play()
    };
    t.Audio.NoMoney = function() {
        t.Audio.ElNoMoney.setAttribute("src", "assets/sound/no-money.mp3");
        t.Audio.ElNoMoney.play()
    };
    t.Audio.Win = function() {
        t.Audio.ElWin.setAttribute("src", "assets/sound/win.mp3");
        t.Audio.ElWin.play()
    };
    t.Audio.Spin = function() {
        t.Audio.ElSpin.setAttribute("src", "assets/sound/spin.mp3");
        t.Audio.ElSpin.volume = .2;
        t.Audio.ElSpin.addEventListener("ended", function() {
            t.Audio.ElSpin.setAttribute("src", "");
            t.Audio.ElSpin.setAttribute("src", "assets/sound/spin.mp3");
            t.Audio.ElSpin.play()
        }, false);
        t.Audio.ElSpin.play()
    };
    t.Audio.Stop = function() {
        t.Audio.ElButton.setAttribute("src", "");
        t.Audio.ElJackpot.setAttribute("src", "");
        t.Audio.ElNoMoney.setAttribute("src", "");
        t.Audio.ElSpin.setAttribute("src", "");
        t.Audio.ElWin.setAttribute("src", "")
    };
    t.Text.All = e(".text");
    t.Text.Jackpot = e("#textJackpot");
    t.Text.Spinning = e("#textSpinning");
    t.Text.Spin = e("#textSpin");
    t.Text.MoneyOver = e("#textMoneyOver");
    t.Text.Won = e("#textWon");
    t.Game.Images = ["assets/images/point-1.png", "assets/images/point-2.png", "assets/images/point-3.png", "assets/images/point-4.png", "assets/images/point-5.png", "assets/images/point-6.png", "assets/images/point-7.png"];
    t.Game.Generate = function() {
        var e = 0;
        var n = 271;
        var r = 0;
        var i = t.Fn.Multiply(t.Game.Images);
        var s = [];
        var o = t.Fn.Shuffle(i);
        for (var u = 0; u < t.Game.FirstRandom; u++) {
            r = t.Fn.Random(0, o.length);
            e = o[r].split("-");
            e = e[1].replace(".png", "");
            s.push('<li class="item" data-point="' + e + '"><img src="' + o[r] + '"></li>')
        }
        t.Game.FirstList.html(s.join("\n"));
        var a = [];
        var f = t.Fn.Shuffle(i);
        for (var l = 0; l < t.Game.SecondRandom; l++) {
            r = t.Fn.Random(0, f.length);
            e = f[r].split("-");
            e = e[1].replace(".png", "");
            a.push('<li class="item" data-point="' + e + '"><img src="' + f[r] + '"></li>')
        }
        t.Game.SecondList.html(a.join("\n"));
        var c = [];
        var h = t.Fn.Shuffle(i);
        for (var p = 0; p < t.Game.ThirdRandom; p++) {
            r = t.Fn.Random(0, h.length);
            e = h[r].split("-");
            e = e[1].replace(".png", "");
            c.push('<li class="item" data-point="' + e + '"><img src="' + h[r] + '"></li>')
        }
        t.Game.ThirdList.html(c.join("\n"));
        t.Game.FirstList.height(n * t.Game.FirstRandom);
        t.Game.FirstList.css("margin-top", -(n * t.Game.FirstRandom - 271));
        t.Game.SecondList.height(n * t.Game.SecondRandom);
        t.Game.SecondList.css("margin-top", -(n * t.Game.SecondRandom - 271));
        t.Game.ThirdList.height(n * t.Game.ThirdRandom);
        t.Game.ThirdList.css("margin-top", -(n * t.Game.ThirdRandom - 271))
    };
    t.Game.Spin = function() {
        var n = 271;
        var r = t.Fn.Random(10, t.Game.FirstRandom);
        var i = r + 2;
        var s = i + 2;
        var o = t.User.Cash;
        var u = t.User.Bet;
        var a = e("#minBet");
        var f = e("#maxBet");
        if (t.Game.FirstList.is(":animated") || t.Game.SecondList.is(":animated") || t.Game.ThirdList.is(":animated") || t.Game.Stop) return false;
        if (t.Fn.Isset(t.Game.FirstItem) && t.Fn.Isset(t.Game.SecondItem) && t.Fn.Isset(t.Game.ThirdItem)) {
            t.Game.Generate();
            t.Game.Append();
            t.Game.FirstList.height(n * t.Game.FirstRandom + n);
            t.Game.FirstList.css("margin-top", -(n * t.Game.FirstRandom));
            t.Game.SecondList.height(n * t.Game.SecondRandom + n);
            t.Game.SecondList.css("margin-top", -(n * t.Game.SecondRandom));
            t.Game.ThirdList.height(n * t.Game.ThirdRandom + n);
            t.Game.ThirdList.css("margin-top", -(n * t.Game.ThirdRandom))
        }
        if (o > 0) {
            t.Game.Loss(u)
        } else {
            t.Game.NoMoney();
            return false
        }
        if (o <= u + 1) {
            a.addClass("disabled");
            f.addClass("disabled")
        }
        t.Game.FirstList.animate({
            marginTop: "+=" + n * r + "px"
        }, {
            duration: r * 100
        });
        t.Game.SecondList.animate({
            marginTop: "+=" + n * i + "px"
        }, {
            duration: i * 100
        });
        t.Game.ThirdList.animate({
            marginTop: "+=" + n * s + "px"
        }, {
            duration: s * 100,
            complete: function() {
                t.Audio.Stop();
                t.Game.Point(t.Game.FirstRandom - r, t.Game.SecondRandom - i, t.Game.ThirdRandom - s)
            }
        });
        t.Audio.Button();
        t.Audio.Spin();
        t.Text.All.hide();
        t.Text.Spinning.fadeIn("slow")
    };
    t.Game.Append = function() {
        t.Game.FirstList.append(t.Game.FirstItem);
        t.Game.SecondList.append(t.Game.SecondItem);
        t.Game.ThirdList.append(t.Game.ThirdItem);
        t.Game.Appended = true
    };
    t.Game.Point = function(n, r, i) {
        if (t.Game.Appended) {
            t.Game.FirstItem = t.Game.FirstList.find("li").eq(n);
            t.Game.SecondItem = t.Game.SecondList.find("li").eq(r);
            t.Game.ThirdItem = t.Game.ThirdList.find("li").eq(i)
        } else {
            t.Game.FirstItem = t.Game.FirstList.find("li").eq(n - 1);
            t.Game.SecondItem = t.Game.SecondList.find("li").eq(r - 1);
            t.Game.ThirdItem = t.Game.ThirdList.find("li").eq(i - 1)
        }
        t.Game.Combinations(t.Game.FirstItem.data("point"), t.Game.SecondItem.data("point"), t.Game.ThirdItem.data("point"));
        var s = t.User.Cash;
        var o = t.User.Bet;
        var u = e("#minBet");
        var a = e("#maxBet");
        if (s == 0) {
            t.Game.NoMoney()
        }
        if (o > s) {
            if (s == 0) {
                t.Game.Bet.html(1);
                t.User.Bet = 1
            } else {
                t.Game.Bet.html(s);
                t.User.Bet = s
            }
        }
        if (s > o) {
            if (o == 3) {
                u.removeClass("disabled");
                a.addClass("disabled")
            } else if (o == 2) {
                u.removeClass("disabled");
                a.removeClass("disabled")
            } else {
                u.addClass("disabled");
                a.removeClass("disabled")
            }
        }
    };
    t.Game.Combinations = function(e, n, r) {
        var i = t.User.Bet;
        t.Text.All.hide();
        if (e == 1 && n == 1 && r == 1) {
            t.Game.Win(i * 1200);
            t.Game.Jackpot()
        } else if (e == 2 && n == 2 && r == 2) {
            t.Game.Win(i * 100);
            t.Text.Won.fadeIn("slow");
            setTimeout(function() {
                t.Text.All.hide();
                t.Text.Spin.fadeIn("slow")
            }, 1e3)
        } else if (e == 3 && n == 3 && r == 3) {
            t.Game.Win(i * 80);
            t.Text.Won.fadeIn("slow");
            setTimeout(function() {
                t.Text.All.hide();
                t.Text.Spin.fadeIn("slow")
            }, 1e3)
        } else if (e == 4 && n == 4 && r == 4) {
            t.Game.Win(i * 60);
            t.Text.Won.fadeIn("slow");
            setTimeout(function() {
                t.Text.All.hide();
                t.Text.Spin.fadeIn("slow")
            }, 1e3)
        } else if (e == 5 && n == 5 && r == 5) {
            t.Game.Win(i * 50);
            t.Text.Won.fadeIn("slow");
            setTimeout(function() {
                t.Text.All.hide();
                t.Text.Spin.fadeIn("slow")
            }, 1e3)
        } else if ((e == 2 || e == 3 || e == 4) && (n == 2 || n == 3 || n == 4) && (r == 2 || r == 3 || r == 4)) {
            t.Game.Win(i * 30);
            t.Text.Won.fadeIn("slow");
            setTimeout(function() {
                t.Text.All.hide();
                t.Text.Spin.fadeIn("slow")
            }, 1e3)
        } else if (e == 6 && n == 6 && r == 6) {
            t.Game.Win(i * 10);
            t.Text.Won.fadeIn("slow");
            setTimeout(function() {
                t.Text.All.hide();
                t.Text.Spin.fadeIn("slow")
            }, 1e3)
        } else if (e == 7 && n == 7 && r == 7 || e == 1 && n == 1 || e == 1 && r == 1 || n == 1 && r == 1) {
            t.Game.Win(i * 5);
            t.Text.Won.fadeIn("slow");
            setTimeout(function() {
                t.Text.All.hide();
                t.Text.Spin.fadeIn("slow")
            }, 1e3)
        } else if (e == 1 || n == 1 || r == 1) {
            t.Game.Win(i * 2);
            t.Text.Won.fadeIn("slow");
            setTimeout(function() {
                t.Text.All.hide();
                t.Text.Spin.fadeIn("slow")
            }, 1e3)
        } else {
            t.Text.Spin.fadeIn("slow")
        }
    };
    t.Game.Controls = function() {
        var n = e("body");
        var r = e("#minBet");
        var i = e("#maxBet");
        var s = e("#Spin");
        t.Game.HidControls.focus();
        n.on("keydown", "#hiddenControls", function(e) {
            if (e.keyCode === 32) {
                t.Game.Spin();
                s.addClass("hover");
                setTimeout(function() {
                    s.removeClass("hover")
                }, 100)
            } else if (e.keyCode === 38) {
                t.Game.Plus();
                i.addClass("active");
                setTimeout(function() {
                    i.removeClass("active")
                }, 100)
            } else if (e.keyCode === 40) {
                t.Game.Minus();
                r.addClass("active");
                setTimeout(function() {
                    r.removeClass("active")
                }, 100)
            }
        });
        n.on("blur", "button, #hiddenControls", function() {
            t.Game.HidControls.focus()
        });
        n.on("click", "#minBet", function(e) {
            t.Game.Minus();
            e.preventDefault()
        });
        n.on("click", "#maxBet", function(e) {
            t.Game.Plus();
            e.preventDefault()
        });
        n.on("click", "#Spin", function(e) {
            t.Game.Spin();
            e.preventDefault()
        });
        e(window).load(function() {
            e("#loading").fadeOut(500)
        })
    };
    t.Game.Plus = function() {
        var n = t.User.Bet;
        var r = t.User.Cash;
        var i = e("#minBet");
        var s = e("#maxBet");
        if (t.Game.FirstList.is(":animated") || t.Game.SecondList.is(":animated") || t.Game.ThirdList.is(":animated") || t.Game.Stop) return false;
        if (n + 1 <= 1) {
            i.addClass("disabled");
            s.removeClass("disabled")
        } else if (n + 1 == 2) {
            i.removeClass("disabled");
            s.removeClass("disabled")
        } else {
            i.removeClass("disabled");
            s.addClass("disabled")
        }
        if (n + 1 == r) {
            s.addClass("disabled")
        }
        if (n < 3 && n < r) {
            t.Game.Bet.html(n + 1);
            t.User.Bet = n + 1
        } else {
            return false
        }
        t.Audio.Button()
    };
    t.Game.Minus = function() {
        var n = t.User.Bet;
        var r = e("#minBet");
        var i = e("#maxBet");
        if (t.Game.FirstList.is(":animated") || t.Game.SecondList.is(":animated") || t.Game.ThirdList.is(":animated") || t.Game.Stop) return false;
        if (n - 1 <= 1) {
            r.addClass("disabled");
            i.removeClass("disabled")
        } else if (n - 1 == 2) {
            r.removeClass("disabled");
            i.removeClass("disabled")
        } else {
            r.removeClass("disabled");
            i.addClass("disabled")
        }
        if (n > 1) {
            t.Game.Bet.html(n - 1);
            t.User.Bet = n - 1
        } else {
            return false
        }
        t.Audio.Button()
    };
    t.Game.Win = function(e) {
        var n = t.User.Cash;
        t.Game.Coins.html(n + e);
        t.User.Cash = n + e;
        t.Audio.Win()
    };
    t.Game.Loss = function(e) {
        var n = t.User.Cash;
        t.Game.Coins.html(n - e);
        t.User.Cash = n - e
    };
    t.Game.NoMoney = function() {
        var n = e("#Spin");
        if (!t.Text.MoneyOver.is(":visible")) {
            t.Text.All.hide();
            t.Text.MoneyOver.fadeIn("slow");
            n.addClass("disabled");
            t.Audio.NoMoney()
        }
    };
    t.Game.Jackpot = function() {
        t.Game.Stop = true;
        t.Audio.Jackpot();
        t.Text.All.hide();
        t.Text.Jackpot.fadeIn("slow");
        setTimeout(function() {
            t.Text.All.hide();
            t.Text.Spin.fadeIn("slow");
            t.Game.Stop = false;
            t.Audio.Stop()
        }, 3e3)
    };
    t.Fn.Shuffle = function(e) {
        for (var t, n, r = e.length; r; t = parseInt(Math.random() * r), n = e[--r], e[r] = e[t], e[t] = n);
        return e
    };
    t.Fn.Multiply = function(e) {
        var n = [];
        var r = t.Game.Percentages;
        for (var i = 0; i < e.length; i++) {
            for (var s = 0; s < r[i]; s++) {
                n.push(e[i])
            }
        }
        return n
    };
    t.Fn.Random = function(e, t) {
        return Math.floor(Math.random() * (t - e)) + e
    };
    t.Fn.Isset = function(e) {
        return e !== undefined && e !== null
    };
    t.Fn.Mobile = function() {
        return navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)
    };
    t.init()
})(jQuery)
